.block
  .content
    .inner
      = form_tag(admin_schedule_path, :method => :get) do
        %table#schedule_template{:val => @template.id}
          %tr
            %td
              Department
              = select_tag :department_id, options_for_select(Department.selection_by_admin(current_admin.id), params[:department_id])
            %td
              &nbsp;
            %td
              = select_date params[:date], :start_year => 2010, :discard_day => true, :use_month_numbers => true
            %td
              &nbsp;
            %td
              %button.button{:type => "submit"}
                = image_tag("web-app-theme/icons/find.png", :alt => "#{t("web-app-theme.find", :default => "Show")}")
                = t("web-app-theme.find", :default => "Show")
            %td
              = check_box_tag :visible,  params[:visible], params[:visible], {:href => set_visibility_admin_schedule_template_path(@template)}
              Visible
        %div#template_users{:style => 'float:left'}
          - @admin = true
          = render 'shared/template_users_show', :layout => false
        %div{:style => 'float:left;padding-left:5px'}
          %table{:cellpadding => 1, :cellspacing => 1, :style => 'background-color:#bbbbbb;text-align:center'}
            %tr
              %td{:style => 'background-color:#ffffff'}
                = link_to image_tag("web-app-theme/icons/application_add.png", :alt => "#{t("web-app-theme.add", :default=> "Add")}") + " " + t("web-app-theme.add", :default=> "Add"),
                  new_admin_schedule_shift_path(:template => @template), :class => "button modal_dialog", :style => "float:right;"
              %td
                %table.cell-table{:cellpadding => 1, :cellspacing => 1, :style => 'background-color:#bbbbbb'}
                  %tr
                  - @days_in_month.times do |day|
                    %td{:style => 'background-color:#eeeeee'}
                      = day + 1
            - @template.schedule_shifts.order(:number).each do |shift|
              %tr
                %td{:style => 'background-color:#eeeeee'}
                  %b
                    - if shift.number == 10
                      DayOff
                    - else
                      Shift #
                      = shift.number
                      %br
                      = shift.start
                      \-
                      = shift.end
                  %br
                    = link_to 'Edit', edit_admin_schedule_shift_path(shift), :id =>"shit_#{shift.id}_edit", :class => "modal_dialog"
                    = link_to 'Delete', admin_schedule_shift_path(shift), :method => :delete, :remote => true, :confirm => 'Delete the Shift#'+shift.number.to_s+'?' unless shift.number == 10
                %td{:id => "shift_#{shift.id}"}
                  = render 'shared/shift_show_admin', :layout => false, :shift => shift
            %tr
              %td{:style => 'background-color:#ffffff'}
                = link_to image_tag("web-app-theme/icons/calendar.png", :alt => "#{t("web-app-theme.add", :default=> "Check")}") + " " + t("web-app-theme.add", :default=> "Check"),
                  check_month_admin_schedule_template_path(@template), :id => 'check_month', :class => "button", :style => "float:right;"
              %td
                %table.cell-table{:cellpadding => 1, :cellspacing => 1, :style => 'background-color:#bbbbbb'}
                  %tr
                  - @days_in_month.times do |day|
                    %td{:style => 'background-color:#eeeeee'}
                      %img{:id => "day_#{day+1}", :src => '/stylesheets/web-app-theme/themes/default/images/menubar-background.png'}
        %div{:style => 'clear:both'}
- content_for :sidebar, render(:partial => 'sidebar')
%div.modal#overlay
  %div.contentWrap
%script{:type => "text/javascript"}
  app.check_month(
  =@template.id
  )
